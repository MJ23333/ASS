import{S as we,i as Ae,s as Ie,Y as Ve,k as d,a as P,l as h,m as _,c as S,h as c,aj as Ze,n,P as Ee,b as B,G as f,T as ie,ak as kt,g as re,v as Le,d as oe,f as Pe,V as yt,W as Je,ai as Et,X as Dt,Z as Qe,C as It,D as Tt,E as Mt,F as Nt,a3 as he,e as fe,I as pe,o as Ut,j as Vt,ab as wt,w as gt,y as ve,z as ge,A as be,H as Se,B as ke,q as F,r as K,u as te,U as Be,a6 as ye,af as At,ag as Lt,N as Te}from"../chunks/index.39b96417.js";import{w as $e,s as xe,h as De,a as et,b as tt,t as lt}from"../chunks/ActivityCards.svelte_svelte_type_style_lang.5dd1f5a1.js";import"../chunks/ProgressBar.svelte_svelte_type_style_lang.552c7a5b.js";import"../chunks/paths.89f36285.js";import{p as Pt}from"../chunks/stores.d0055b78.js";import{p as bt}from"../chunks/popup.7096bba0.js";import{P as St,A as Bt,a as jt}from"../chunks/ProgressRadial.2f47bfaf.js";import{p as zt,a as Ct}from"../chunks/helper.a6c21644.js";import{g as at}from"../chunks/navigation.25373cf1.js";function st(s){let e,t;const a=s[22].default,i=It(a,s,s[21],null);return{c(){e=d("div"),i&&i.c(),this.h()},l(r){e=h(r,"DIV",{class:!0});var l=_(e);i&&i.l(l),l.forEach(c),this.h()},h(){n(e,"class","slide-toggle-text ml-3")},m(r,l){B(r,e,l),i&&i.m(e,null),t=!0},p(r,l){i&&i.p&&(!t||l[0]&2097152)&&Tt(i,a,r,r[21],t?Nt(a,r[21],l,null):Mt(r[21]),null)},i(r){t||(re(i,r),t=!0)},o(r){oe(i,r),t=!1},d(r){r&&c(e),i&&i.d(r)}}}function Ht(s){let e,t,a,i,r,l,o,u,p,v,N,k,g,U,C,w=[{type:"checkbox"},{class:"slide-toggle-input hidden"},{name:s[1]},s[8](),{disabled:i=s[9].disabled}],j={};for(let y=0;y<w.length;y+=1)j=Ve(j,w[y]);let E=s[10].default&&st(s);return{c(){e=d("div"),t=d("label"),a=d("input"),r=P(),l=d("div"),o=d("div"),v=P(),E&&E.c(),this.h()},l(y){e=h(y,"DIV",{id:!0,class:!0,"data-testid":!0,role:!0,"aria-label":!0,"aria-checked":!0,tabindex:!0});var D=_(e);t=h(D,"LABEL",{class:!0});var O=_(t);a=h(O,"INPUT",{type:!0,class:!0,name:!0}),r=S(O),l=h(O,"DIV",{class:!0});var b=_(l);o=h(b,"DIV",{class:!0}),_(o).forEach(c),b.forEach(c),v=S(O),E&&E.l(O),O.forEach(c),D.forEach(c),this.h()},h(){Ze(a,j),n(o,"class",u="slide-toggle-thumb "+s[3]),Ee(o,"cursor-not-allowed",s[9].disabled),n(l,"class",p="slide-toggle-track "+s[4]),Ee(l,"cursor-not-allowed",s[9].disabled),n(t,"class",N="slide-toggle-label "+s[5]),n(e,"id",s[2]),n(e,"class",k="slide-toggle "+s[6]),n(e,"data-testid","slide-toggle"),n(e,"role","switch"),n(e,"aria-label",s[2]),n(e,"aria-checked",s[0]),n(e,"tabindex","0")},m(y,D){B(y,e,D),f(e,t),f(t,a),a.autofocus&&a.focus(),a.checked=s[0],f(t,r),f(t,l),f(l,o),f(t,v),E&&E.m(t,null),g=!0,U||(C=[ie(a,"change",s[31]),ie(a,"click",s[23]),ie(a,"keydown",s[24]),ie(a,"keyup",s[25]),ie(a,"keypress",s[26]),ie(a,"mouseover",s[27]),ie(a,"change",s[28]),ie(a,"focus",s[29]),ie(a,"blur",s[30]),ie(e,"keydown",s[7])],U=!0)},p(y,D){Ze(a,j=kt(w,[{type:"checkbox"},{class:"slide-toggle-input hidden"},(!g||D[0]&2)&&{name:y[1]},y[8](),(!g||D[0]&512&&i!==(i=y[9].disabled))&&{disabled:i}])),D[0]&1&&(a.checked=y[0]),(!g||D[0]&8&&u!==(u="slide-toggle-thumb "+y[3]))&&n(o,"class",u),(!g||D[0]&520)&&Ee(o,"cursor-not-allowed",y[9].disabled),(!g||D[0]&16&&p!==(p="slide-toggle-track "+y[4]))&&n(l,"class",p),(!g||D[0]&528)&&Ee(l,"cursor-not-allowed",y[9].disabled),y[10].default?E?(E.p(y,D),D[0]&1024&&re(E,1)):(E=st(y),E.c(),re(E,1),E.m(t,null)):E&&(Le(),oe(E,1,1,()=>{E=null}),Pe()),(!g||D[0]&32&&N!==(N="slide-toggle-label "+y[5]))&&n(t,"class",N),(!g||D[0]&4)&&n(e,"id",y[2]),(!g||D[0]&64&&k!==(k="slide-toggle "+y[6]))&&n(e,"class",k),(!g||D[0]&4)&&n(e,"aria-label",y[2]),(!g||D[0]&1)&&n(e,"aria-checked",y[0])},i(y){g||(re(E),g=!0)},o(y){oe(E),g=!1},d(y){y&&c(e),E&&E.d(),U=!1,yt(C)}}}const Ot="inline-block",Rt="unstyled flex items-center",Gt="flex transition-all duration-[200ms] cursor-pointer",qt="w-[50%] h-full scale-[0.8] transition-all duration-[200ms] shadow";function Ft(s,e,t){let a,i,r,l,o,u,p,v;const N=["name","checked","size","background","active","border","rounded","label"];let k=Je(e,N),{$$slots:g={},$$scope:U}=e;const C=Et(g),w=Dt();let{name:j}=e,{checked:E=!1}=e,{size:y="md"}=e,{background:D="bg-surface-400 dark:bg-surface-700"}=e,{active:O="bg-surface-900 dark:bg-surface-300"}=e,{border:b=""}=e,{rounded:L="rounded-full"}=e,{label:z=""}=e,I;switch(y){case"sm":I="w-12 h-6";break;case"lg":I="w-20 h-10";break;default:I="w-16 h-8"}function M(m){["Enter","Space"].includes(m.code)&&(m.preventDefault(),w("keyup",m),m.currentTarget.firstChild.click())}function A(){return delete k.class,k}function se(m){he.call(this,s,m)}function X(m){he.call(this,s,m)}function W(m){he.call(this,s,m)}function ae(m){he.call(this,s,m)}function x(m){he.call(this,s,m)}function le(m){he.call(this,s,m)}function ee(m){he.call(this,s,m)}function R(m){he.call(this,s,m)}function V(){E=this.checked,t(0,E)}return s.$$set=m=>{t(9,e=Ve(Ve({},e),Qe(m))),t(33,k=Je(e,N)),"name"in m&&t(1,j=m.name),"checked"in m&&t(0,E=m.checked),"size"in m&&t(11,y=m.size),"background"in m&&t(12,D=m.background),"active"in m&&t(13,O=m.active),"border"in m&&t(14,b=m.border),"rounded"in m&&t(15,L=m.rounded),"label"in m&&t(2,z=m.label),"$$scope"in m&&t(21,U=m.$$scope)},s.$$.update=()=>{s.$$.dirty[0]&12289&&t(19,a=E?O:`${D} cursor-pointer`),s.$$.dirty[0]&1&&t(18,i=E?"bg-white/75":"bg-white"),s.$$.dirty[0]&1&&t(17,r=E?"translate-x-full":""),t(20,l=e.disabled===!0?"opacity-50":"hover:brightness-[105%] dark:hover:brightness-110 cursor-pointer"),t(6,o=`${Ot} ${L} ${l} ${e.class??""}`),s.$$.dirty[0]&638976&&t(4,p=`${Gt} ${b} ${L} ${I} ${a}`),s.$$.dirty[0]&425984&&t(3,v=`${qt} ${L} ${i} ${r}`)},t(5,u=`${Rt}`),e=Qe(e),[E,j,z,v,p,u,o,M,A,e,C,y,D,O,b,L,I,r,i,a,l,U,g,se,X,W,ae,x,le,ee,R,V]}class Kt extends we{constructor(e){super(),Ae(this,e,Ft,Ht,Ie,{name:1,checked:0,size:11,background:12,active:13,border:14,rounded:15,label:2},null,[-1,-1])}}let Wt={root:null,rootMargin:"0px",threshold:0};const je=(s,e)=>{const t=()=>{console.log("loaded"),s.style.opacity="1"};return new IntersectionObserver(i=>{i[0].isIntersecting&&(console.log("an image has loaded"),s.src=e,s.complete?t():s.addEventListener("load",t))},Wt).observe(s),{destroy(){s.removeEventListener("load",t)}}};function rt(s,e,t){const a=s.slice();return a[29]=e[t],a}function it(s,e,t){const a=s.slice();return a[32]=e[t][0],a[33]=e[t][1],a}function ot(s,e,t){const a=s.slice();return a[26]=e[t],a}function Xt(s){let e,t,a;return t=new St({props:{"...":!0,stroke:100,meter:"stroke-primary-500",track:"stroke-primary-500/30"}}),{c(){e=d("div"),ve(t.$$.fragment),this.h()},l(i){e=h(i,"DIV",{class:!0});var r=_(e);ge(t.$$.fragment,r),r.forEach(c),this.h()},h(){n(e,"class","w-full flex justify-center p-5")},m(i,r){B(i,e,r),be(t,e,null),a=!0},p:Se,i(i){a||(re(t.$$.fragment,i),a=!0)},o(i){oe(t.$$.fragment,i),a=!1},d(i){i&&c(e),ke(t)}}}function Yt(s){let e,t;return e=new Bt({props:{$$slots:{header:[fl],default:[al]},$$scope:{ctx:s}}}),e.$on("scroll",s[7]),{c(){ve(e.$$.fragment)},l(a){ge(e.$$.fragment,a)},m(a,i){be(e,a,i),t=!0},p(a,i){const r={};i[0]&59|i[1]&32&&(r.$$scope={dirty:i,ctx:a}),e.$set(r)},i(a){t||(re(e.$$.fragment,a),t=!0)},o(a){oe(e.$$.fragment,a),t=!1},d(a){ke(e,a)}}}function nt(s){let e,t,a=s[5].infoUnlockDatas[s[4].storyMeta.prev].storyName+" "+s[5].infoUnlockDatas[s[4].storyMeta.prev].avgTag,i,r;return{c(){e=d("a"),t=d("i"),i=F(a),this.h()},l(l){e=h(l,"A",{href:!0});var o=_(e);t=h(o,"I",{class:!0}),_(t).forEach(c),i=K(o,a),o.forEach(c),this.h()},h(){n(t,"class","fas fa-running fa-flip-horizontal"),n(e,"href",r="/story/"+s[5].infoUnlockDatas[s[4].storyMeta.prev].storyTxt)},m(l,o){B(l,e,o),f(e,t),f(e,i)},p(l,o){o[0]&48&&a!==(a=l[5].infoUnlockDatas[l[4].storyMeta.prev].storyName+" "+l[5].infoUnlockDatas[l[4].storyMeta.prev].avgTag)&&te(i,a),o[0]&48&&r!==(r="/story/"+l[5].infoUnlockDatas[l[4].storyMeta.prev].storyTxt)&&n(e,"href",r)},d(l){l&&c(e)}}}function ft(s){let e,t=s[5].infoUnlockDatas[s[4].storyMeta.next].storyName+" "+s[5].infoUnlockDatas[s[4].storyMeta.next].avgTag,a,i,r;return{c(){e=d("a"),a=F(t),i=d("i"),this.h()},l(l){e=h(l,"A",{href:!0});var o=_(e);a=K(o,t),i=h(o,"I",{class:!0}),_(i).forEach(c),o.forEach(c),this.h()},h(){n(i,"class","fas fa-running"),n(e,"href",r="/story/"+s[5].infoUnlockDatas[s[4].storyMeta.next].storyTxt)},m(l,o){B(l,e,o),f(e,a),f(e,i)},p(l,o){o[0]&48&&t!==(t=l[5].infoUnlockDatas[l[4].storyMeta.next].storyName+" "+l[5].infoUnlockDatas[l[4].storyMeta.next].avgTag)&&te(a,t),o[0]&48&&r!==(r="/story/"+l[5].infoUnlockDatas[l[4].storyMeta.next].storyTxt)&&n(e,"href",r)},d(l){l&&c(e)}}}function Zt(s){let e,t,a,i,r,l,o,u;return{c(){e=d("div"),t=d("button"),a=d("i"),i=F("音乐停止"),r=P(),this.h()},l(p){e=h(p,"DIV",{class:!0,id:!0,"data-musicid":!0});var v=_(e);t=h(v,"BUTTON",{});var N=_(t);a=h(N,"I",{class:!0}),_(a).forEach(c),i=K(N,"音乐停止"),N.forEach(c),r=S(v),v.forEach(c),this.h()},h(){n(a,"class","fas fa-volume-mute px-3"),n(e,"class","md:flex pt-1 pb-1 justify-center text-primary-800 music"),n(e,"id",l="line"+s[29].id),n(e,"data-musicid","-999")},m(p,v){B(p,e,v),f(e,t),f(t,a),f(t,i),f(e,r),o||(u=ie(t,"click",s[12]),o=!0)},p(p,v){v[0]&16&&l!==(l="line"+p[29].id)&&n(e,"id",l)},d(p){p&&c(e),o=!1,u()}}}function Jt(s){let e,t=s[29].key&&ct(s);return{c(){t&&t.c(),e=fe()},l(a){t&&t.l(a),e=fe()},m(a,i){t&&t.m(a,i),B(a,e,i)},p(a,i){a[29].key?t?t.p(a,i):(t=ct(a),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},d(a){t&&t.d(a),a&&c(e)}}}function Qt(s){let e,t,a,i,r,l,o,u;return{c(){e=d("div"),t=d("img"),r=P(),this.h()},l(p){e=h(p,"DIV",{class:!0,id:!0});var v=_(e);t=h(v,"IMG",{class:!0,alt:!0}),r=S(v),v.forEach(c),this.h()},h(){n(t,"class","md:w-3/5 aspect-[21/9] object-cover"),n(t,"alt",a=s[29].image),n(e,"class","md:flex pt-4 pb-2 justify-center"),n(e,"id",l="line"+s[29].id)},m(p,v){B(p,e,v),f(e,t),f(e,r),o||(u=ye(i=je.call(null,t,s[29].image)),o=!0)},p(p,v){s=p,v[0]&16&&a!==(a=s[29].image)&&n(t,"alt",a),i&&Te(i.update)&&v[0]&16&&i.update.call(null,s[29].image),v[0]&16&&l!==(l="line"+s[29].id)&&n(e,"id",l)},d(p){p&&c(e),o=!1,u()}}}function $t(s){let e,t,a,i,r,l,o,u;return{c(){e=d("div"),t=d("img"),r=P(),this.h()},l(p){e=h(p,"DIV",{class:!0,id:!0});var v=_(e);t=h(v,"IMG",{class:!0,alt:!0}),r=S(v),v.forEach(c),this.h()},h(){n(t,"class","md:w-3/5 aspect-[21/9] object-cover"),n(t,"alt",a=s[29].image),n(e,"class","md:flex pt-4 pb-2 justify-center"),n(e,"id",l="line"+s[29].id)},m(p,v){B(p,e,v),f(e,t),f(e,r),o||(u=ye(i=je.call(null,t,s[29].image)),o=!0)},p(p,v){s=p,v[0]&16&&a!==(a=s[29].image)&&n(t,"alt",a),i&&Te(i.update)&&v[0]&16&&i.update.call(null,s[29].image),v[0]&16&&l!==(l="line"+s[29].id)&&n(e,"id",l)},d(p){p&&c(e),o=!1,u()}}}function xt(s){let e,t,a,i,r=s[29].references.join(",")+"",l,o,u,p,v;return{c(){e=d("div"),t=d("div"),a=d("span"),i=F("Option "),l=F(r),o=P(),u=d("div"),p=P(),this.h()},l(N){e=h(N,"DIV",{class:!0,id:!0});var k=_(e);t=h(k,"DIV",{class:!0});var g=_(t);a=h(g,"SPAN",{class:!0});var U=_(a);i=K(U,"Option "),l=K(U,r),U.forEach(c),g.forEach(c),o=S(k),u=h(k,"DIV",{class:!0}),_(u).forEach(c),p=S(k),k.forEach(c),this.h()},h(){n(a,"class","opt"),n(t,"class","basis-1/6 text-right pr-3 text-primary-600 font-bold text-sm inline"),n(u,"class","basis-5/6 text-primary-50 inline"),n(e,"class","md:flex pt-4 pb-2"),n(e,"id",v="line"+s[29].id)},m(N,k){B(N,e,k),f(e,t),f(t,a),f(a,i),f(a,l),f(e,o),f(e,u),f(e,p)},p(N,k){k[0]&16&&r!==(r=N[29].references.join(",")+"")&&te(l,r),k[0]&16&&v!==(v="line"+N[29].id)&&n(e,"id",v)},d(N){N&&c(e)}}}function el(s){let e,t,a=Object.entries(s[29].options),i=[];for(let r=0;r<a.length;r+=1)i[r]=ut(it(s,a,r));return{c(){e=d("div");for(let r=0;r<i.length;r+=1)i[r].c();t=P(),this.h()},l(r){e=h(r,"DIV",{class:!0});var l=_(e);for(let o=0;o<i.length;o+=1)i[o].l(l);t=S(l),l.forEach(c),this.h()},h(){n(e,"class","py-3")},m(r,l){B(r,e,l);for(let o=0;o<i.length;o+=1)i[o]&&i[o].m(e,null);f(e,t)},p(r,l){if(l[0]&16){a=Object.entries(r[29].options);let o;for(o=0;o<a.length;o+=1){const u=it(r,a,o);i[o]?i[o].p(u,l):(i[o]=ut(u),i[o].c(),i[o].m(e,t))}for(;o<i.length;o+=1)i[o].d(1);i.length=a.length}},d(r){r&&c(e),Be(i,r)}}}function tl(s){let e,t,a=s[29].text.replace("\\n","<br/>")+"",i,r;return{c(){e=d("div"),t=d("div"),i=P(),this.h()},l(l){e=h(l,"DIV",{class:!0,id:!0});var o=_(e);t=h(o,"DIV",{class:!0});var u=_(t);u.forEach(c),i=S(o),o.forEach(c),this.h()},h(){n(t,"class","text-primary-50 md:w-5/8"),n(e,"class","flex py-2 justify-center"),n(e,"id",r="line"+s[29].id)},m(l,o){B(l,e,o),f(e,t),t.innerHTML=a,f(e,i)},p(l,o){o[0]&16&&a!==(a=l[29].text.replace("\\n","<br/>")+"")&&(t.innerHTML=a),o[0]&16&&r!==(r="line"+l[29].id)&&n(e,"id",r)},d(l){l&&c(e)}}}function ll(s){let e,t,a,i,r=s[29].name+"",l,o,u,p,v=s[29].text.replace("\\n","<br/>")+"",N,k,g,U,C,w,j=s[29].name+"",E,y,D,O,b,L,z,I=s[29].figure&&dt(s);return{c(){e=d("div"),t=d("div"),a=d("button"),i=d("span"),l=F(r),u=P(),p=d("div"),N=P(),k=d("div"),I&&I.c(),g=P(),U=d("a"),C=F("在PRTS上搜索"),w=d("span"),E=F(j),b=P(),this.h()},l(M){e=h(M,"DIV",{class:!0,id:!0});var A=_(e);t=h(A,"DIV",{class:!0});var se=_(t);a=h(se,"BUTTON",{class:!0});var X=_(a);i=h(X,"SPAN",{});var W=_(i);l=K(W,r),W.forEach(c),X.forEach(c),se.forEach(c),u=S(A),p=h(A,"DIV",{class:!0});var ae=_(p);ae.forEach(c),N=S(A),k=h(A,"DIV",{class:!0,"data-popup":!0});var x=_(k);I&&I.l(x),g=S(x),U=h(x,"A",{class:!0,target:!0,href:!0});var le=_(U);C=K(le,"在PRTS上搜索"),w=h(le,"SPAN",{class:!0});var ee=_(w);E=K(ee,j),ee.forEach(c),le.forEach(c),x.forEach(c),A.forEach(c),b=S(M),this.h()},h(){n(a,"class",""),n(t,"class","md:basis-1/6 md:text-right pr-3 text-primary-600 font-bold inline text-left"),n(p,"class","basis-5/6 text-primary-50 md:flex inline"),n(w,"class","font-bold"),n(U,"class","text-center m-auto block"),n(U,"target","_blank"),n(U,"href",y="https://prts.wiki/index.php?search="+s[29].name+"&profile=advanced&fulltext=1&ns0=1&ns3000=1"),n(k,"class","card border-4 border-primary-800"),n(k,"data-popup",D="popupHover"+s[29].id.toString()),n(e,"class","md:flex py-1 margin:auto"),n(e,"id",O=s[29].id)},m(M,A){B(M,e,A),f(e,t),f(t,a),f(a,i),f(i,l),f(e,u),f(e,p),p.innerHTML=v,f(e,N),f(e,k),I&&I.m(k,null),f(k,g),f(k,U),f(U,C),f(U,w),f(w,E),B(M,b,A),L||(z=ye(o=bt.call(null,a,{event:"click",target:"popupHover"+s[29].id.toString(),placement:"top"})),L=!0)},p(M,A){s=M,A[0]&16&&r!==(r=s[29].name+"")&&te(l,r),o&&Te(o.update)&&A[0]&16&&o.update.call(null,{event:"click",target:"popupHover"+s[29].id.toString(),placement:"top"}),A[0]&16&&v!==(v=s[29].text.replace("\\n","<br/>")+"")&&(p.innerHTML=v),s[29].figure?I?I.p(s,A):(I=dt(s),I.c(),I.m(k,g)):I&&(I.d(1),I=null),A[0]&16&&j!==(j=s[29].name+"")&&te(E,j),A[0]&16&&y!==(y="https://prts.wiki/index.php?search="+s[29].name+"&profile=advanced&fulltext=1&ns0=1&ns3000=1")&&n(U,"href",y),A[0]&16&&D!==(D="popupHover"+s[29].id.toString())&&n(k,"data-popup",D),A[0]&16&&O!==(O=s[29].id)&&n(e,"id",O)},d(M){M&&c(e),I&&I.d(),M&&c(b),L=!1,z()}}}function ct(s){let e,t,a,i=s[29].key.split("/").slice(-1)[0]+"",r,l,o,u,p,v;function N(){return s[11](s[29])}return{c(){e=d("div"),t=d("button"),a=d("i"),r=F(i),l=P(),this.h()},l(k){e=h(k,"DIV",{class:!0,id:!0,"data-musicid":!0});var g=_(e);t=h(g,"BUTTON",{});var U=_(t);a=h(U,"I",{class:!0}),_(a).forEach(c),r=K(U,i),U.forEach(c),l=S(g),g.forEach(c),this.h()},h(){n(a,"class","inline-block fas fa-volume-up px-3 m-auto"),n(e,"class","md:flex pt-1 pb-1 justify-center text-primary-800 music"),n(e,"id",o="line"+s[29].id),n(e,"data-musicid",u=s[29].musicid)},m(k,g){B(k,e,g),f(e,t),f(t,a),f(t,r),f(e,l),p||(v=ie(t,"click",N),p=!0)},p(k,g){s=k,g[0]&16&&i!==(i=s[29].key.split("/").slice(-1)[0]+"")&&te(r,i),g[0]&16&&o!==(o="line"+s[29].id)&&n(e,"id",o),g[0]&16&&u!==(u=s[29].musicid)&&n(e,"data-musicid",u)},d(k){k&&c(e),p=!1,v()}}}function ut(s){let e,t,a=s[33].text+"",i,r;return{c(){e=d("div"),t=d("span"),i=F(a),this.h()},l(l){e=h(l,"DIV",{class:!0,id:!0});var o=_(e);t=h(o,"SPAN",{class:!0});var u=_(t);i=K(u,a),u.forEach(c),o.forEach(c),this.h()},h(){n(t,"class","dec"),n(e,"class","text-primary-50 text-center p-2 font-bold"),n(e,"id",r="line"+s[29].id+"opt"+s[32])},m(l,o){B(l,e,o),f(e,t),f(t,i)},p(l,o){o[0]&16&&a!==(a=l[33].text+"")&&te(i,a),o[0]&16&&r!==(r="line"+l[29].id+"opt"+l[32])&&n(e,"id",r)},d(l){l&&c(e)}}}function dt(s){let e,t,a,i,r;return{c(){e=d("img"),this.h()},l(l){e=h(l,"IMG",{class:!0,alt:!0}),this.h()},h(){n(e,"class","w-52 flex aspect-[21/9] object-cover object-top m-auto"),n(e,"alt",t=s[29].name)},m(l,o){B(l,e,o),i||(r=ye(a=je.call(null,e,s[29].figure)),i=!0)},p(l,o){s=l,o[0]&16&&t!==(t=s[29].name)&&n(e,"alt",t),a&&Te(a.update)&&o[0]&16&&a.update.call(null,s[29].figure)},d(l){l&&c(e),i=!1,r()}}}function ht(s){let e,t;function a(l,o){if(o[0]&16&&(e=null),(l[29].type=="dialogue"||l[29].type=="multiline"||l[29].type=="subtitle")&&l[29].text)return ll;if((l[29].type=="text"||l[29].type=="sticker")&&l[29].text)return tl;if(l[29].type=="decision")return el;if(l[29].type=="predicate"&&l[29].references)return xt;if(l[29].type=="background"&&l[29].image)return $t;if(l[29].type=="image"&&l[29].image)return Qt;if(l[29].type=="playmusic")return Jt;if(e==null&&(e=l[29].type.toLowerCase()=="stopmusic"),e)return Zt}let i=a(s,[-1,-1]),r=i&&i(s);return{c(){r&&r.c(),t=fe()},l(l){r&&r.l(l),t=fe()},m(l,o){r&&r.m(l,o),B(l,t,o)},p(l,o){i===(i=a(l,o))&&r?r.p(l,o):(r&&r.d(1),r=i&&i(l),r&&(r.c(),r.m(t.parentNode,t)))},d(l){r&&r.d(l),l&&c(t)}}}function _t(s){let e,t,a=s[5].infoUnlockDatas[s[4].storyMeta.prev].storyName+" "+s[5].infoUnlockDatas[s[4].storyMeta.prev].avgTag,i,r;return{c(){e=d("a"),t=d("i"),i=F(a),this.h()},l(l){e=h(l,"A",{href:!0});var o=_(e);t=h(o,"I",{class:!0}),_(t).forEach(c),i=K(o,a),o.forEach(c),this.h()},h(){n(t,"class","fas fa-running fa-flip-horizontal"),n(e,"href",r="/story/"+s[5].infoUnlockDatas[s[4].storyMeta.prev].storyTxt)},m(l,o){B(l,e,o),f(e,t),f(e,i)},p(l,o){o[0]&48&&a!==(a=l[5].infoUnlockDatas[l[4].storyMeta.prev].storyName+" "+l[5].infoUnlockDatas[l[4].storyMeta.prev].avgTag)&&te(i,a),o[0]&48&&r!==(r="/story/"+l[5].infoUnlockDatas[l[4].storyMeta.prev].storyTxt)&&n(e,"href",r)},d(l){l&&c(e)}}}function pt(s){let e,t=s[5].infoUnlockDatas[s[4].storyMeta.next].storyName+" "+s[5].infoUnlockDatas[s[4].storyMeta.next].avgTag,a,i,r;return{c(){e=d("a"),a=F(t),i=d("i"),this.h()},l(l){e=h(l,"A",{href:!0});var o=_(e);a=K(o,t),i=h(o,"I",{class:!0}),_(i).forEach(c),o.forEach(c),this.h()},h(){n(i,"class","fas fa-running"),n(e,"href",r="/story/"+s[5].infoUnlockDatas[s[4].storyMeta.next].storyTxt)},m(l,o){B(l,e,o),f(e,a),f(e,i)},p(l,o){o[0]&48&&t!==(t=l[5].infoUnlockDatas[l[4].storyMeta.next].storyName+" "+l[5].infoUnlockDatas[l[4].storyMeta.next].avgTag)&&te(a,t),o[0]&48&&r!==(r="/story/"+l[5].infoUnlockDatas[l[4].storyMeta.next].storyTxt)&&n(e,"href",r)},d(l){l&&c(e)}}}function al(s){let e,t,a,i,r,l,o,u,p=s[5].name+"",v,N,k,g,U,C,w,j=s[4].storyMeta.storyName+"",E,y,D,O=s[4].storyMeta.avgTag+"",b,L,z,I,M,A,se,X,W,ae,x,le,ee,R,V=s[5].name+"",m,q,ce,ne,Z=s[4].storyMeta.prev!=null&&nt(s),J=s[4].storyMeta.next!=null&&ft(s),ue=s[4].lines,Y=[];for(let T=0;T<ue.length;T+=1)Y[T]=ht(rt(s,ue,T));let Q=s[4].storyMeta.prev!=null&&_t(s),$=s[4].storyMeta.next!=null&&pt(s);return{c(){e=d("main"),t=d("div"),a=d("div"),Z&&Z.c(),i=P(),r=d("div"),l=d("span"),o=d("i"),u=d("a"),v=F(p),k=P(),g=d("div"),J&&J.c(),U=P(),C=d("div"),w=d("span"),E=F(j),y=d("span"),D=d("span"),b=F(O),L=P(),z=d("div"),I=P(),M=d("div"),A=d("div");for(let T=0;T<Y.length;T+=1)Y[T].c();se=P(),X=d("div"),W=d("div"),Q&&Q.c(),ae=P(),x=d("div"),le=d("span"),ee=d("i"),R=d("a"),m=F(V),ce=P(),ne=d("div"),$&&$.c(),this.h()},l(T){e=h(T,"MAIN",{});var H=_(e);t=h(H,"DIV",{class:!0});var G=_(t);a=h(G,"DIV",{class:!0});var de=_(a);Z&&Z.l(de),de.forEach(c),i=S(G),r=h(G,"DIV",{class:!0});var _e=_(r);l=h(_e,"SPAN",{class:!0});var ze=_(l);o=h(ze,"I",{class:!0}),_(o).forEach(c),ze.forEach(c),u=h(_e,"A",{href:!0});var Ce=_(u);v=K(Ce,p),Ce.forEach(c),_e.forEach(c),k=S(G),g=h(G,"DIV",{class:!0});var He=_(g);J&&J.l(He),He.forEach(c),G.forEach(c),U=S(H),C=h(H,"DIV",{class:!0});var Me=_(C);w=h(Me,"SPAN",{class:!0});var Oe=_(w);E=K(Oe,j),Oe.forEach(c),y=h(Me,"SPAN",{});var Re=_(y);D=h(Re,"SPAN",{class:!0});var Ge=_(D);b=K(Ge,O),Ge.forEach(c),Re.forEach(c),Me.forEach(c),L=S(H),z=h(H,"DIV",{id:!0,class:!0}),_(z).forEach(c),I=S(H),M=h(H,"DIV",{class:!0});var qe=_(M);A=h(qe,"DIV",{class:!0});var Fe=_(A);for(let Ue=0;Ue<Y.length;Ue+=1)Y[Ue].l(Fe);Fe.forEach(c),qe.forEach(c),se=S(H),X=h(H,"DIV",{class:!0});var me=_(X);W=h(me,"DIV",{class:!0});var Ke=_(W);Q&&Q.l(Ke),Ke.forEach(c),ae=S(me),x=h(me,"DIV",{class:!0});var Ne=_(x);le=h(Ne,"SPAN",{class:!0});var We=_(le);ee=h(We,"I",{class:!0}),_(ee).forEach(c),We.forEach(c),R=h(Ne,"A",{href:!0});var Xe=_(R);m=K(Xe,V),Xe.forEach(c),Ne.forEach(c),ce=S(me),ne=h(me,"DIV",{class:!0});var Ye=_(ne);$&&$.l(Ye),Ye.forEach(c),me.forEach(c),H.forEach(c),this.h()},h(){n(a,"class","text-left"),n(o,"class","fas fa-undo"),n(l,"class","font-normal"),n(u,"href",N="/activity/"+s[5].id),n(r,"class","text-center"),n(g,"class","text-right"),n(t,"class","grid grid-cols-3 m-auto md:w-3/4 p-4 font-bold"),n(w,"class","text-right sm:text-5xl text-4xl font-black inline-block pr-4"),n(D,"class","text-left sm:text-3xl text-2xl font-bold inline-block"),n(C,"class","flex justify-center py-4 items-end"),n(z,"id","aplayer"),n(z,"class","text-primary-700"),n(A,"class","text-lg w-3/4 block m-auto"),n(M,"class","block"),n(W,"class","text-left"),n(ee,"class","fas fa-undo"),n(le,"class","font-normal"),n(R,"href",q="/activity/"+s[5].id),n(x,"class","text-center"),n(ne,"class","text-right"),n(X,"class","grid grid-cols-3 m-auto md:w-3/4 p-4 font-bold")},m(T,H){B(T,e,H),f(e,t),f(t,a),Z&&Z.m(a,null),f(t,i),f(t,r),f(r,l),f(l,o),f(r,u),f(u,v),f(t,k),f(t,g),J&&J.m(g,null),f(e,U),f(e,C),f(C,w),f(w,E),f(C,y),f(y,D),f(D,b),f(e,L),f(e,z),f(e,I),f(e,M),f(M,A);for(let G=0;G<Y.length;G+=1)Y[G]&&Y[G].m(A,null);s[13](M),f(e,se),f(e,X),f(X,W),Q&&Q.m(W,null),f(X,ae),f(X,x),f(x,le),f(le,ee),f(x,R),f(R,m),f(X,ce),f(X,ne),$&&$.m(ne,null)},p(T,H){if(T[4].storyMeta.prev!=null?Z?Z.p(T,H):(Z=nt(T),Z.c(),Z.m(a,null)):Z&&(Z.d(1),Z=null),H[0]&32&&p!==(p=T[5].name+"")&&te(v,p),H[0]&32&&N!==(N="/activity/"+T[5].id)&&n(u,"href",N),T[4].storyMeta.next!=null?J?J.p(T,H):(J=ft(T),J.c(),J.m(g,null)):J&&(J.d(1),J=null),H[0]&16&&j!==(j=T[4].storyMeta.storyName+"")&&te(E,j),H[0]&16&&O!==(O=T[4].storyMeta.avgTag+"")&&te(b,O),H[0]&17){ue=T[4].lines;let G;for(G=0;G<ue.length;G+=1){const de=rt(T,ue,G);Y[G]?Y[G].p(de,H):(Y[G]=ht(de),Y[G].c(),Y[G].m(A,null))}for(;G<Y.length;G+=1)Y[G].d(1);Y.length=ue.length}T[4].storyMeta.prev!=null?Q?Q.p(T,H):(Q=_t(T),Q.c(),Q.m(W,null)):Q&&(Q.d(1),Q=null),H[0]&32&&V!==(V=T[5].name+"")&&te(m,V),H[0]&32&&q!==(q="/activity/"+T[5].id)&&n(R,"href",q),T[4].storyMeta.next!=null?$?$.p(T,H):($=pt(T),$.c(),$.m(ne,null)):$&&($.d(1),$=null)},d(T){T&&c(e),Z&&Z.d(),J&&J.d(),Be(Y,T),s[13](null),Q&&Q.d(),$&&$.d()}}}function sl(s){let e,t,a=s[26].storyName+" "+s[26].avgTag,i,r,l;return{c(){e=d("li"),t=d("a"),i=F(a),l=P(),this.h()},l(o){e=h(o,"LI",{class:!0});var u=_(e);t=h(u,"A",{href:!0});var p=_(t);i=K(p,a),p.forEach(c),l=S(u),u.forEach(c),this.h()},h(){n(t,"href",r="/story/"+s[26].storyTxt),n(e,"class","p-1")},m(o,u){B(o,e,u),f(e,t),f(t,i),f(e,l)},p(o,u){u[0]&32&&a!==(a=o[26].storyName+" "+o[26].avgTag)&&te(i,a),u[0]&32&&r!==(r="/story/"+o[26].storyTxt)&&n(t,"href",r)},d(o){o&&c(e)}}}function rl(s){let e,t,a=s[26].storyName+" "+s[26].avgTag,i,r;return{c(){e=d("li"),t=d("p"),i=F(a),r=P(),this.h()},l(l){e=h(l,"LI",{class:!0});var o=_(e);t=h(o,"P",{});var u=_(t);i=K(u,a),u.forEach(c),r=S(o),o.forEach(c),this.h()},h(){n(e,"class","text-primary-700 p-1")},m(l,o){B(l,e,o),f(e,t),f(t,i),f(e,r)},p(l,o){o[0]&32&&a!==(a=l[26].storyName+" "+l[26].avgTag)&&te(i,a)},d(l){l&&c(e)}}}function mt(s){let e;function t(r,l){return r[26].storyTxt==r[4].storyMeta.storyTxt?rl:sl}let a=t(s),i=a(s);return{c(){i.c(),e=fe()},l(r){i.l(r),e=fe()},m(r,l){i.m(r,l),B(r,e,l)},p(r,l){a===(a=t(r))&&i?i.p(r,l):(i.d(1),i=a(r),i&&(i.c(),i.m(e.parentNode,e)))},d(r){i.d(r),r&&c(e)}}}function il(s){let e,t,a,i,r,l,o,u,p,v,N,k,g,U,C,w,j,E=s[5].name+"",y,D,O,b,L,z,I,M,A=s[4].storyMeta.storyName+" "+s[4].storyMeta.avgTag,se,X,W,ae,x,le,ee=s[5].infoUnlockDatas,R=[];for(let V=0;V<ee.length;V+=1)R[V]=mt(ot(s,ee,V));return{c(){e=d("ol"),t=d("li"),a=d("a"),i=F("主页"),r=P(),l=d("li"),o=F("/"),u=P(),p=d("li"),v=d("a"),N=F("活动选择"),k=P(),g=d("li"),U=F("/"),C=P(),w=d("li"),j=d("a"),y=F(E),O=P(),b=d("li"),L=F("/"),z=P(),I=d("li"),M=d("button"),se=F(A),X=P(),W=d("div"),ae=d("ul");for(let V=0;V<R.length;V+=1)R[V].c();this.h()},l(V){e=h(V,"OL",{class:!0});var m=_(e);t=h(m,"LI",{class:!0});var q=_(t);a=h(q,"A",{class:!0,href:!0});var ce=_(a);i=K(ce,"主页"),ce.forEach(c),q.forEach(c),r=S(m),l=h(m,"LI",{class:!0,"aria-hidden":!0});var ne=_(l);o=K(ne,"/"),ne.forEach(c),u=S(m),p=h(m,"LI",{class:!0});var Z=_(p);v=h(Z,"A",{class:!0,href:!0});var J=_(v);N=K(J,"活动选择"),J.forEach(c),Z.forEach(c),k=S(m),g=h(m,"LI",{class:!0,"aria-hidden":!0});var ue=_(g);U=K(ue,"/"),ue.forEach(c),C=S(m),w=h(m,"LI",{class:!0});var Y=_(w);j=h(Y,"A",{class:!0,href:!0});var Q=_(j);y=K(Q,E),Q.forEach(c),Y.forEach(c),O=S(m),b=h(m,"LI",{class:!0,"aria-hidden":!0});var $=_(b);L=K($,"/"),$.forEach(c),z=S(m),I=h(m,"LI",{class:!0});var T=_(I);M=h(T,"BUTTON",{class:!0});var H=_(M);se=K(H,A),H.forEach(c),T.forEach(c),m.forEach(c),X=S(V),W=h(V,"DIV",{class:!0,"data-popup":!0});var G=_(W);ae=h(G,"UL",{});var de=_(ae);for(let _e=0;_e<R.length;_e+=1)R[_e].l(de);de.forEach(c),G.forEach(c),this.h()},h(){n(a,"class","font-bold text-primary-700"),n(a,"href","/"),n(t,"class","crumb"),n(l,"class","crumb-separator"),n(l,"aria-hidden",""),n(v,"class","font-bold text-primary-700"),n(v,"href","/activities"),n(p,"class","crumb"),n(g,"class","crumb-separator"),n(g,"aria-hidden",""),n(j,"class","font-bold text-primary-700"),n(j,"href",D="/activity/"+s[5].id),n(w,"class","crumb"),n(b,"class","crumb-separator"),n(b,"aria-hidden",""),n(M,"class","font-bold"),n(I,"class","crumb"),n(e,"class","breadcrumb flex"),n(W,"class","card p-4 max-h-96 overflow-scroll"),n(W,"data-popup","popupList")},m(V,m){B(V,e,m),f(e,t),f(t,a),f(a,i),f(e,r),f(e,l),f(l,o),f(e,u),f(e,p),f(p,v),f(v,N),f(e,k),f(e,g),f(g,U),f(e,C),f(e,w),f(w,j),f(j,y),f(e,O),f(e,b),f(b,L),f(e,z),f(e,I),f(I,M),f(M,se),B(V,X,m),B(V,W,m),f(W,ae);for(let q=0;q<R.length;q+=1)R[q]&&R[q].m(ae,null);x||(le=ye(bt.call(null,M,s[6])),x=!0)},p(V,m){if(m[0]&32&&E!==(E=V[5].name+"")&&te(y,E),m[0]&32&&D!==(D="/activity/"+V[5].id)&&n(j,"href",D),m[0]&16&&A!==(A=V[4].storyMeta.storyName+" "+V[4].storyMeta.avgTag)&&te(se,A),m[0]&48){ee=V[5].infoUnlockDatas;let q;for(q=0;q<ee.length;q+=1){const ce=ot(V,ee,q);R[q]?R[q].p(ce,m):(R[q]=mt(ce),R[q].c(),R[q].m(ae,null))}for(;q<R.length;q+=1)R[q].d(1);R.length=ee.length}},d(V){V&&c(e),V&&c(X),V&&c(W),Be(R,V),x=!1,le()}}}function ol(s){let e;return{c(){e=d("i"),this.h()},l(t){e=h(t,"I",{class:!0}),_(e).forEach(c),this.h()},h(){n(e,"class","fas fa-music")},m(t,a){B(t,e,a)},p:Se,d(t){t&&c(e)}}}function nl(s){let e,t,a;function i(l){s[10](l)}let r={name:"slider-label",$$slots:{default:[ol]},$$scope:{ctx:s}};return s[1]!==void 0&&(r.checked=s[1]),e=new Kt({props:r}),gt.push(()=>At(e,"checked",i)),{c(){ve(e.$$.fragment)},l(l){ge(e.$$.fragment,l)},m(l,o){be(e,l,o),a=!0},p(l,o){const u={};o[1]&32&&(u.$$scope={dirty:o,ctx:l}),!t&&o[0]&2&&(t=!0,u.checked=l[1],Lt(()=>t=!1)),e.$set(u)},i(l){a||(re(e.$$.fragment,l),a=!0)},o(l){oe(e.$$.fragment,l),a=!1},d(l){ke(e,l)}}}function fl(s){let e,t;return e=new jt({props:{gridColumns:"grid-cols-2",slotDefault:"place-self-left",slotTrail:"place-content-end",$$slots:{trail:[nl],default:[il]},$$scope:{ctx:s}}}),{c(){ve(e.$$.fragment)},l(a){ge(e.$$.fragment,a)},m(a,i){be(e,a,i),t=!0},p(a,i){const r={};i[0]&50|i[1]&32&&(r.$$scope={dirty:i,ctx:a}),e.$set(r)},i(a){t||(re(e.$$.fragment,a),t=!0)},o(a){oe(e.$$.fragment,a),t=!1},d(a){ke(e,a)}}}function cl(s){let e,t,a,i;const r=[Yt,Xt],l=[];function o(u,p){return u[2]?0:1}return e=o(s),t=l[e]=r[e](s),{c(){t.c(),a=fe()},l(u){t.l(u),a=fe()},m(u,p){l[e].m(u,p),B(u,a,p),i=!0},p(u,p){let v=e;e=o(u),e===v?l[e].p(u,p):(Le(),oe(l[v],1,1,()=>{l[v]=null}),Pe(),t=l[e],t?t.p(u,p):(t=l[e]=r[e](u),t.c()),re(t,1),t.m(a.parentNode,a))},i(u){i||(re(t),i=!0)},o(u){oe(t),i=!1},d(u){l[e].d(u),u&&c(a)}}}function ul(s,e,t){let a,i,r,l,o,u;pe(s,$e,b=>t(1,a=b)),pe(s,xe,b=>t(4,i=b)),pe(s,De,b=>t(17,r=b)),pe(s,et,b=>t(18,l=b)),pe(s,tt,b=>t(5,o=b)),pe(s,lt,b=>t(19,u=b));var p=!1;let{params:v}=e;const N={event:"focus-click",target:"popupList",placement:"bottom"};Ut(async function(){if(l.length==0||u.length==0){var b=await zt();et.set(b.activities),lt.set(b.types);for(var L of l){if(!r[L.id]){var z={...r};z[L.id]={lastread:0},De.set(z)}for(var I of L.infoUnlockDatas)if(!r[L.id][I.storyTxt]){console.log(r[L.id]);var z={...r};z[L.id][I.storyTxt]={lastread:0},De.set(z)}}console.log(r),console.log("get")}var M=await Ct(v.id);if(!M.storyMeta)o.name?at(`/activity/${o.id}`):at("/activities/");else{xe.set(M);for(var L of l)if(L.id==i.storyMeta.storyGroup){tt.set(L);var z={...r};z[L.id].lastread=Date.now(),z[L.id][M.storyMeta.storyTxt].lastread=Date.now(),De.set(z)}t(2,p=!0),console.log("story"),console.log(i)}});var k,g,U=[],C=[],w=null;function j(b){if(C.length>0&&g){var L=document.getElementById("page").getBoundingClientRect().bottom/1.5,z=document.getElementsByClassName("music"),I=null;for(var M of z)M.getBoundingClientRect().bottom<L&&(I=Number(M.dataset.musicid));t(9,w=I)}}Vt(()=>{if(C=[],i.lines){for(var b of i.lines)b.type=="playmusic"&&b.key&&C.push({name:b.key.split("/").slice(-1)[0],artist:"塞壬唱片",url:b.key});if(C.length!=0&&U.length!=C.length&&document.getElementById("aplayer")){t(0,g=new APlayer({container:document.getElementById("aplayer"),fixed:!0,autoplay:!1,theme:"#9b9b9b",loop:"one",order:"random",preload:"auto",volume:.7,mutex:!0,listFolded:!1,listMaxHeight:90,lrcType:3,audio:C})),U=C;var L=document.getElementById("page").getBoundingClientRect().bottom/1.5,z=document.getElementsByClassName("music"),I=null;for(var M of z)M.getBoundingClientRect().bottom<L&&(I=Number(M.dataset.musicid));t(9,w=I)}}}),wt(()=>{console.log("des"),g&&g.destroy(),t(0,g=null)});function E(b){a=b,$e.set(a)}const y=b=>{g.list.switch(b.musicid),g.play()},D=()=>{g.pause()};function O(b){gt[b?"unshift":"push"](()=>{k=b,t(3,k)})}return s.$$set=b=>{"params"in b&&t(8,v=b.params)},s.$$.update=()=>{s.$$.dirty[0]&515&&(console.log(w),g&&(w!=null&&w>=0?(console.log(w),g.list.switch(w),a?g.play():g.pause()):g.pause()))},[g,a,p,k,i,o,N,j,v,w,E,y,D,O]}class dl extends we{constructor(e){super(),Ae(this,e,ul,cl,Ie,{params:8},null,[-1,-1])}}function vt(s){let e,t;return e=new dl({props:{params:s[0].params}}),{c(){ve(e.$$.fragment)},l(a){ge(e.$$.fragment,a)},m(a,i){be(e,a,i),t=!0},p(a,i){const r={};i&1&&(r.params=a[0].params),e.$set(r)},i(a){t||(re(e.$$.fragment,a),t=!0)},o(a){oe(e.$$.fragment,a),t=!1},d(a){ke(e,a)}}}function hl(s){let e,t=s[0].params,a,i,r=vt(s);return{c(){e=P(),r.c(),a=fe()},l(l){e=S(l),r.l(l),a=fe()},m(l,o){B(l,e,o),r.m(l,o),B(l,a,o),i=!0},p(l,[o]){o&1&&Ie(t,t=l[0].params)?(Le(),oe(r,1,1,Se),Pe(),r=vt(l),r.c(),re(r,1),r.m(a.parentNode,a)):r.p(l,o)},i(l){i||(re(r),i=!0)},o(l){oe(r),i=!1},d(l){l&&c(e),l&&c(a),r.d(l)}}}function _l(s,e,t){let a;return pe(s,Pt,i=>t(0,a=i)),[a]}class Il extends we{constructor(e){super(),Ae(this,e,_l,hl,Ie,{})}}export{Il as component};
